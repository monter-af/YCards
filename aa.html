<!DOCTYPE html>
<html lang="ru">
<head>
    <title>Добавление на карту GeoJSON файла из Конструктора карт</title>
    <meta charset="utf-8">

    <style>
        html, body, .map {
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
        }
    </style>

    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <!-- <script src="https://code.jquery.com/jquery-3.7.1.js"></script> -->
    <script src="https://api-maps.yandex.ru/2.1/?apikey=aba747f6-b17f-41b6-b603-844f2c6c603a&lang=ru_RU" type="text/javascript"></script>

    <script type="text/javascript">
        ymaps.ready(init);
        
        function init() {
            let cityColors = [
                {name: "г. Арсеньев",       color: "blue",   altcolor: "darkBlue"   },
                {name: "г. Артем",          color: "gray",   altcolor: "night"      },
                {name: "г. Большой Камень", color: "green",  altcolor: "darkGreen"  },
                {name: "г. Владивосток",    color: "orange", altcolor: "darkOrange" },
                {name: "г. Находка",        color: "black",  altcolor: "brown"      },
                {name: "г. Уссурийск",      color: "pink",   altcolor: "lightPink"  },
                {name: "п. Зима Южная",     color: "brown",  altcolor: "olive"      },
                {name: "п. Новый",          color: "yellow", altcolor: "lightBlue"  },
                {name: "п. Трудовое",       color: "violet", altcolor: "darkViolet" },

            ];
            var map = new ymaps.Map('map', {
                       center: [43.115542, 131.885494],
                       zoom: 4,
                    controls: ['zoomControl']
                });
            var objectManager = new ymaps.ObjectManager();
            map.controls.get('zoomControl').options.set({size: 'small'});
            objectManager.objects.options.set('preset', 'islands#greenDotIcon');
            objectManager.clusters.options.set('preset', 'islands#greenClusterIcons');
    
            // Добавляем объекты на карту.
            map.geoObjects.add(objectManager);

            $.ajax({
                url: "https://script.google.com/macros/s/AKfycbzy8WqeBuAprUxdnd3Y9m1Vr8xnbMCNrFpMXbIpN_yykVwi5KKkaLIrp4jLhN3-Mx5Q/exec"
                // type: "GET",
                // success: function (data) {
                //     data.features.forEach(function (obj) {
                //         obj.properties.balloonContent = obj.properties.description;
                //         var currentColor = cityColors.filter((el) => el.name === obj.properties.city);
                    
                //         // if (obj.properties.type == 'Новострой'){}
                //         // obj.options = {
                //         //     preset: "islands#" + 
                //         //             (obj.properties.type == 'Новострой' ? currentColor[0].color : currentColor[0].altcolor ) + 
                //         //             "DotIconWithCaption"
                //         // }
                //         delete obj.properties.description;
                //         delete obj.properties.city;
                //         delete obj.properties.type;
                //         delete obj.properties.finished;
                //         // Добавляем описание объектов в формате JSON в менеджер объектов.
                //         objectManager = objectManager.add(obj);
                //     });
                // }
            }).done(function(data) {
                objectManager.add(data);
            });
        };
    </script>
</head>
<body>
<div id="map" class="map"></div>
</body>
</html>
